<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pedidos - Pixel</title>
  <link rel="stylesheet" href="css/styles.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>

<!-- ============================= HEADER ============================= -->

<div class="topbar">
  <div class="brand">
    <span class="logo-fox">ü¶ä</span> Pixel
  </div>

  <button class="hamburger" aria-label="Men√∫">‚ò∞</button>

  <div class="nav-links">
     <a href="./index.html">Inicio</a>
     <a href="./insumos.html">Insumos</a>
     <a href="./stock.html">Stock</a>
     <a href="./productos.html">Productos</a>
     <a href="./clientes.html">Clientes</a>     
     <a href="./guia.html">Guia</a>
     <a href="./costos.html">Costos</a>
     <a href="./recetas_borrador.html">Recetas guardadas</a>
     <a class="active" href="./pedidos.html">Pedidos</a>
     <a href="./catalogo.html">Catalogo</a>
     <a href="./calendario.html">Calendario</a>
  </div>
</div>


<div class="main">

<!-- ============================= ENCABEZADO ============================= -->

<div class="card">
  <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px;">
    <div>
      <h1>Pedidos</h1>
      <p class="hint">
        Pedidos con uno o varios productos, se calcula el total y se genera un detalle para enviar por WhatsApp üí∏.
      </p>
    </div>

    <a href="produccion.html" class="btn btn-primary btn-produccion">
      üè≠ Ir a Producci√≥n
    </a>
  </div>
</div>


<!-- ============================= FORMULARIO ============================= -->

<div class="card">

  <h3>Datos del cliente</h3>

  <div class="form-grid">
    <div class="form-group">
      <label>Cliente</label>
      <input id="clienteNombre" placeholder="Nombre del cliente" list="clientesDatalist">
      <datalist id="clientesDatalist"></datalist>
    </div>

    <div class="form-group">
      <label>Tel√©fono</label>
      <input id="clienteTelefono" placeholder="Tel√©fono">
    </div>

    <div class="form-group">
      <label>Red / Contacto</label>
      <input id="clienteRed" placeholder="Instagram / WhatsApp">
    </div>
  </div>

  <h3 style="margin-top:1.5rem;">Productos del pedido</h3>

  <div class="form-grid">
    <div class="form-group">
      <label>Producto</label>
      <select id="productoSelect">
        <option value="">Cargando productos...</option>
      </select>
    </div>

    <div class="form-group">
      <label>Cantidad</label>
      <input id="cantidadInput" type="number" min="1" value="1">
    </div>

    <div class="form-group" style="align-self:flex-end;">
      <button id="agregarItemBtn" class="btn btn-primary">‚ûï Agregar</button>
    </div>
  </div>

  <!-- üî• BOT√ìN ITEM PERSONALIZADO -->
  <div style="margin-top:12px;">
    <button type="button" id="btnItemPersonalizado" class="btn btn-outline">
      ‚ûï √çtem personalizado
    </button>
  </div>

  <!-- üî• BLOQUE ITEM PERSONALIZADO -->
  <div id="itemPersonalizadoBox" style="display:none; margin-top:12px;">
    <div class="form-grid">

      <div class="form-group">
        <label>Descripci√≥n</label>
        <input id="itemPersonalizadoNombre" placeholder="Ej: Trabajo especial, env√≠o, dise√±o...">
      </div>

      <div class="form-group">
        <label>Precio</label>
        <input id="itemPersonalizadoPrecio" type="number" min="0">
      </div>

      <div class="form-group">
        <label>Cantidad</label>
        <input id="itemPersonalizadoCantidad" type="number" min="1" value="1">
      </div>

      <div class="form-group" style="align-self:flex-end;">
        <button id="agregarItemPersonalizadoBtn" class="btn btn-primary">
          Agregar
        </button>
      </div>

    </div>
  </div>


  <!-- TABLA ITEMS -->
  <table class="tabla-stock" style="margin-top:1rem;">
    <thead>
      <tr>
        <th>Producto</th>
        <th>Precio</th>
        <th>Cant</th>
        <th>Subtotal</th>
        <th></th>
      </tr>
    </thead>
    <tbody id="pedidoItems"></tbody>
  </table>

  <p style="text-align:right; margin-top:1rem; font-size:1.05rem;">
    <strong>Total:</strong> $<span id="totalPedido">0</span>
  </p>


  <!-- DATOS PEDIDO -->
  <div class="form-grid" style="margin-top:1rem;">
    <div class="form-group">
      <label>Fecha</label>
      <input id="pedidoFecha" type="date">
    </div>

    <div class="form-group">
      <label>Estado</label>
      <select id="pedidoEstado">
        <option value="PENDIENTE">üü• Pendiente</option>
        <option value="PROCESO">üü® En proceso</option>
        <option value="LISTO">üü™ Listo</option>
        <option value="ENTREGADO">üü© Entregado</option>
      </select>
    </div>

    <div class="form-group">
      <label>Nota</label>
      <input id="pedidoNota" placeholder="Detalles extra (opcional)">
    </div>
  </div>

  <div style="margin-top:0.5rem;">
    <label style="display:flex; align-items:center; gap:8px;">
      <input type="checkbox" id="pedidoPagado" style="width:18px; height:18px;">
      <span>Pagado</span>
    </label>
  </div>

  <div style="text-align:right; margin-top:1.2rem;">
    <button id="limpiarPedidoBtn" class="btn btn-secondary">Limpiar</button>
    <button id="guardarPedidoBtn" class="btn btn-primary">Guardar pedido</button>
  </div>

</div>


<!-- ============================= RESTO IGUAL (Lista, Modales, etc) ============================= -->
<!-- Todo lo que ya ten√≠as debajo queda exactamente igual -->

<script type="module" src="js/firebase.js"></script>
<script type="module" src="js/pedidos.js?v=3"></script>

<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }
</script>

<script src="js/ui.js"></script>
<script src="js/app.js"></script>

</body>
</html>
